"use strict";(self.webpackChunkdr_pe_ui_storybook=self.webpackChunkdr_pe_ui_storybook||[]).push([[9822],{"./src/Components/Zmz/MobilePickerView/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>MobilePickerView});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),classNames=__webpack_require__("./src/Unit/classNames.ts");const style_module_picker_container="style_picker_container__R8WDs",style_module_picker_inner="style_picker_inner__afMMW",style_module_picker_highlight="style_picker_highlight__VYkk7",style_module_picker_column="style_picker_column__t6Gd5",style_module_picker_scroller="style_picker_scroller__kN+Vb",style_module_picker_item="style_picker_item__XHsHf",style_module_picker_item_selected="style_picker_item_selected__YkjUU";var defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),transformValue=function transformValue(value,node){var val=Number(value.split(/[A-z]/)[0]);val=isNaN(val)?0:val;var element=node;switch(!0){case value.includes("rem"):return 10*val;case value.includes("em"):var emVal=16;return element&&element.parentElement&&(emVal=Number(window.getComputedStyle(element.parentElement).fontSize.slice(0,-2))),val*emVal;default:return val}},jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),PickerColumn=function PickerColumn(props){var _getTranslate$startSc,name=props.name,value=props.value,options=props.options,itemHeight=props.itemHeight,columnHeight=props.columnHeight,_props$wheel=props.wheel,wheel=void 0===_props$wheel?"off":_props$wheel,onChange=props.onChange,onClick=props.onClick,getTranslate=(0,react.useMemo)((function(){var selectedIndex=options.indexOf(value),columnHeightVal=transformValue(columnHeight),itemHeightVal=transformValue(itemHeight);return selectedIndex<0&&(console.warn('Warning: "'.concat(name,'" doesn\'t contain an option of "').concat(value,'".')),null==onChange||onChange(name,options[0]),selectedIndex=0),{startScrollerTranslate:columnHeightVal/2-itemHeightVal/2-selectedIndex*itemHeightVal,minTranslate:columnHeightVal/2-itemHeightVal*options.length+itemHeightVal/2,maxTranslate:columnHeightVal/2-itemHeightVal/2}}),[columnHeight,itemHeight,name,options,value]),_useState=(0,react.useState)(null!==(_getTranslate$startSc=null==getTranslate?void 0:getTranslate.startScrollerTranslate)&&void 0!==_getTranslate$startSc?_getTranslate$startSc:0),_useState2=(0,slicedToArray.Z)(_useState,2),scrollerTranslate=_useState2[0],setScrollerTranslate=_useState2[1],transformOptions=(0,react.useRef)(null),transitionType=(0,react.useRef)(null),clickValue=(0,react.useRef)(""),wheelValue=(0,react.useRef)(""),touchValue=(0,react.useRef)(""),srcollerWrapRef=(0,react.useRef)(null);(0,react.useEffect)((function(){return removeEventListener(),addEventListener(),function(){removeEventListener()}}),[options]),(0,react.useLayoutEffect)((function(){null===transformOptions.current?transformOptions.current=(0,objectSpread2.Z)({isMoving:!1,startTouchY:0},getTranslate):transformOptions.current=(0,objectSpread2.Z)((0,objectSpread2.Z)({},transformOptions.current),getTranslate);var index=options.indexOf(value),scrollerValue=calcScrollerValue(index);setScrollerTranslate(scrollerValue)}),[getTranslate,props]);var addEventListener=function addEventListener(){var _srcollerWrapRef$curr,_srcollerWrapRef$curr2,_srcollerWrapRef$curr3,_srcollerWrapRef$curr4,_srcollerWrapRef$curr5;null===(_srcollerWrapRef$curr=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr||_srcollerWrapRef$curr.addEventListener("wheel",handleWheel),null===(_srcollerWrapRef$curr2=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr2||_srcollerWrapRef$curr2.addEventListener("touchstart",handleTouchStart),null===(_srcollerWrapRef$curr3=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr3||_srcollerWrapRef$curr3.addEventListener("touchmove",handleTouchMove),null===(_srcollerWrapRef$curr4=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr4||_srcollerWrapRef$curr4.addEventListener("touchend",handleTouchEnd),null===(_srcollerWrapRef$curr5=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr5||_srcollerWrapRef$curr5.addEventListener("touchcancel",handleTouchCancel)},removeEventListener=function removeEventListener(){var _srcollerWrapRef$curr6,_srcollerWrapRef$curr7,_srcollerWrapRef$curr8,_srcollerWrapRef$curr9,_srcollerWrapRef$curr10;null===(_srcollerWrapRef$curr6=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr6||_srcollerWrapRef$curr6.removeEventListener("wheel",handleWheel),null===(_srcollerWrapRef$curr7=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr7||_srcollerWrapRef$curr7.removeEventListener("touchstart",handleTouchStart),null===(_srcollerWrapRef$curr8=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr8||_srcollerWrapRef$curr8.removeEventListener("touchmove",handleTouchMove),null===(_srcollerWrapRef$curr9=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr9||_srcollerWrapRef$curr9.removeEventListener("touchend",handleTouchEnd),null===(_srcollerWrapRef$curr10=srcollerWrapRef.current)||void 0===_srcollerWrapRef$curr10||_srcollerWrapRef$curr10.removeEventListener("touchcancel",handleTouchCancel)},calcScrollerValue=function calcScrollerValue(selectedIndex){return transformOptions.current?transformOptions.current.maxTranslate-selectedIndex*transformValue(itemHeight):0},handleTouchEndorCancel=function handleTouchEndorCancel(type){if(transformOptions.current){transitionType.current="touch";var opt=transformOptions.current;if(!opt.isMoving)return;opt.isMoving=!1,opt.startTouchY=0,opt.startScrollerTranslate=0,setScrollerTranslate((function(val){if("end"===type){var index=handleScrollerTranslateSattled(val);touchValue.current=options[index]}else touchValue.current=options[0];return val}))}},handleScrollerTranslateSattled=function handleScrollerTranslateSattled(scrollerTranslate){var activeIndex=0;if(transformOptions.current){var _transformOptions$cur=transformOptions.current,minTranslate=_transformOptions$cur.minTranslate,maxTranslate=_transformOptions$cur.maxTranslate,itemHeightVal=transformValue(itemHeight);activeIndex=scrollerTranslate>=maxTranslate?0:scrollerTranslate<=minTranslate?options.length-1:-Math.round((scrollerTranslate-maxTranslate)/itemHeightVal)}return activeIndex},handleWheel=function handleWheel(event){event.preventDefault(),transitionType.current="wheel";var itemHeightVal=transformValue(itemHeight),delta=.1*event.deltaY;switch(delta=itemHeightVal*Math.sign(delta),wheel){case"natural":break;case"normal":delta*=-1;break;default:return}setScrollerTranslate((function(value){var scrollerValue=value+delta,index=handleScrollerTranslateSattled(scrollerValue);return wheelValue.current=options[index],scrollerValue}))},handleTouchStart=function handleTouchStart(event){if(transformOptions.current){var opt=transformOptions.current,startTouchY=event.targetTouches[0].pageY;setScrollerTranslate((function(val){return opt.startTouchY=startTouchY,opt.startScrollerTranslate=val,val}))}},handleTouchMove=function handleTouchMove(event){if(transformOptions.current){var opt=transformOptions.current,startScrollerTranslate=opt.startScrollerTranslate,startTouchY=opt.startTouchY,minTranslate=opt.minTranslate,maxTranslate=opt.maxTranslate;event.preventDefault();var touchY=event.targetTouches[0].pageY;if(!opt.isMoving)return void(opt.isMoving=!0);var nextScrollerTranslate=startScrollerTranslate+touchY-startTouchY;nextScrollerTranslate<minTranslate?nextScrollerTranslate=minTranslate-Math.pow(minTranslate-nextScrollerTranslate,.8):nextScrollerTranslate>maxTranslate&&(nextScrollerTranslate=maxTranslate+Math.pow(nextScrollerTranslate-maxTranslate,.8)),setScrollerTranslate((function(){return nextScrollerTranslate}))}},handleTouchEnd=function handleTouchEnd(){handleTouchEndorCancel("end")},handleTouchCancel=function handleTouchCancel(){handleTouchEndorCancel("cancel")},translateString="translate(0, ".concat(scrollerTranslate,"px)");return(0,jsx_runtime.jsx)("div",{className:style_module_picker_column,ref:srcollerWrapRef,children:(0,jsx_runtime.jsx)("div",{className:style_module_picker_scroller,style:{transform:translateString},onTransitionEnd:function onTransitionEnd(){transitionType.current&&function handleScrollerTransition(type){switch(type){case"wheel":var option=wheelValue.current;null==onChange||onChange(name,option);break;case"touch":var _option=touchValue.current;null==onChange||onChange(name,_option);break;case"click":var _option2=clickValue.current;_option2===value?null==onClick||onClick(name,value):null==onChange||onChange(name,_option2)}}(transitionType.current),transitionType.current=null},children:function renderItems(){return options.map((function(option,index){var style={height:itemHeight,lineHeight:itemHeight};return(0,jsx_runtime.jsx)("div",{style,className:(0,classNames.Z)(style_module_picker_item,(0,defineProperty.Z)({},"".concat(style_module_picker_item_selected),option===value)),onClick:function onClick(){return function handleItemClick(option){transitionType.current="click",clickValue.current=option;var selectIndex=options.indexOf(option),scrollerValue=calcScrollerValue(selectIndex);setScrollerTranslate(scrollerValue)}(option)},children:option},index)}))}()})})};try{PickerColumn.displayName="PickerColumn",PickerColumn.__docgenInfo={description:"",displayName:"PickerColumn",props:{name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"string[]"}},itemHeight:{defaultValue:null,description:"",name:"itemHeight",required:!0,type:{name:"string"}},columnHeight:{defaultValue:null,description:"",name:"columnHeight",required:!0,type:{name:"string"}},wheel:{defaultValue:null,description:"",name:"wheel",required:!1,type:{name:"enum",value:[{value:'"off"'},{value:'"natural"'},{value:'"normal"'}]}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((key: string, val: string) => void)"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((key: string, val: string) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Components/Zmz/MobilePickerView/Unit/PickerColumn.tsx#PickerColumn"]={docgenInfo:PickerColumn.__docgenInfo,name:"PickerColumn",path:"src/Components/Zmz/MobilePickerView/Unit/PickerColumn.tsx#PickerColumn"})}catch(__react_docgen_typescript_loader_error){}var MobilePickerView=function MobilePickerView(_ref){var className=_ref.className,style=_ref.style,valueGroups=_ref.valueGroups,optionGroups=_ref.optionGroups,_ref$itemHeight=_ref.itemHeight,itemHeight=void 0===_ref$itemHeight?"3.6rem":_ref$itemHeight,_ref$height=_ref.height,height=void 0===_ref$height?"21.6rem":_ref$height,_ref$wheel=_ref.wheel,wheel=void 0===_ref$wheel?"off":_ref$wheel,onChange=_ref.onChange,onClick=_ref.onClick;return(0,jsx_runtime.jsx)("div",{className:(0,classNames.Z)(style_module_picker_container,className),style:(0,objectSpread2.Z)({height},style),children:(0,jsx_runtime.jsxs)("div",{className:style_module_picker_inner,children:[Object.keys(optionGroups).map((function(name){return(0,jsx_runtime.jsx)(PickerColumn,{name,value:valueGroups[name],options:optionGroups[name],itemHeight,columnHeight:height,wheel,onChange,onClick},name)})),(0,jsx_runtime.jsx)("div",{className:style_module_picker_highlight,style:{height:itemHeight}})]})})};try{MobilePickerView.displayName="MobilePickerView",MobilePickerView.__docgenInfo={description:"",displayName:"MobilePickerView",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},valueGroups:{defaultValue:null,description:"",name:"valueGroups",required:!0,type:{name:"ValGroups"}},optionGroups:{defaultValue:null,description:"",name:"optionGroups",required:!0,type:{name:"OptGroups"}},itemHeight:{defaultValue:{value:"3.6rem"},description:"",name:"itemHeight",required:!1,type:{name:"string"}},height:{defaultValue:{value:"21.6rem"},description:"",name:"height",required:!1,type:{name:"string"}},wheel:{defaultValue:{value:"off"},description:"",name:"wheel",required:!1,type:{name:"enum",value:[{value:'"off"'},{value:'"natural"'},{value:'"normal"'}]}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"((key: string, val: string) => void)"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((key: string, val: string) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Components/Zmz/MobilePickerView/index.tsx#MobilePickerView"]={docgenInfo:MobilePickerView.__docgenInfo,name:"MobilePickerView",path:"src/Components/Zmz/MobilePickerView/index.tsx#MobilePickerView"})}catch(__react_docgen_typescript_loader_error){}},"./src/Unit/getPosition.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>getLanguage});var getLanguageByBrowser=function getLanguageByBrowser(){return"zh"===window.navigator.language.split("-")[0]?"cn":"en"},getLanguage=function getLanguage(){return function getLanguageByGeolocation(){return new Promise((function(resolve,reject){window.navigator.geolocation||reject(null),window.addEventListener("load",(function(){resolve(getLanguageByBrowser())}),{once:!0})}))}()}}}]);